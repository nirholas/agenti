<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="100% Free Crypto News API - No API keys, no rate limits"><link href="https://free-crypto-news.vercel.app/API-BACKEND-COMPARISON/" rel="canonical"><link rel="icon" href="../assets/favicon.svg"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>API Routes and Backend Logic Comparison - Free Crypto News</title><link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css"><link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel="stylesheet" href="../css/timeago.css"><link rel="stylesheet" href="../stylesheets/extra.css"><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="orange"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#api-routes-and-backend-logic-comparison" class="md-skip"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="Header"> <a href=".." title="Free Crypto News" class="md-header__button md-logo" aria-label="Free Crypto News" data-md-component="logo"> <img src="../assets/logo.svg" alt="logo"> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Free Crypto News </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> API Routes and Backend Logic Comparison </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="orange" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input class="md-option" data-md-color-media data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="orange" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class="md-search__options" aria-label="Search"> <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text data-md-component="search-share" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/nirholas/free-crypto-news" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class="md-source__repository"> nirholas/free-crypto-news </div> </a> </div> </nav> <nav class="md-tabs" aria-label="Tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a href=".." class="md-tabs__link"> Home </a> </li> <li class="md-tabs__item"> <a href="../API/" class="md-tabs__link"> API Reference </a> </li> <li class="md-tabs__item"> <a href="../USER-GUIDE/" class="md-tabs__link"> Guides </a> </li> <li class="md-tabs__item"> <a href="../sdks/" class="md-tabs__link"> SDKs </a> </li> <li class="md-tabs__item"> <a href="../integrations/" class="md-tabs__link"> Integrations </a> </li> <li class="md-tabs__item"> <a href="../examples/" class="md-tabs__link"> Examples </a> </li> <li class="md-tabs__item"> <a href="../DEPLOYMENT/" class="md-tabs__link"> Deployment </a> </li> <li class="md-tabs__item"> <a href="../CONTRIBUTING/" class="md-tabs__link"> Community </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href=".." title="Free Crypto News" class="md-nav__button md-logo" aria-label="Free Crypto News" data-md-component="logo"> <img src="../assets/logo.svg" alt="logo"> </a> Free Crypto News </label> <div class="md-nav__source"> <a href="https://github.com/nirholas/free-crypto-news" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class="md-source__repository"> nirholas/free-crypto-news </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1"> <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0"> <span class="md-ellipsis"> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_1"> <span class="md-nav__icon md-icon"></span> Home </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href=".." class="md-nav__link"> <span class="md-ellipsis"> Welcome </span> </a> </li> <li class="md-nav__item"> <a href="../QUICKSTART/" class="md-nav__link"> <span class="md-ellipsis"> Quick Start </span> </a> </li> <li class="md-nav__item"> <a href="../CHANGELOG/" class="md-nav__link"> <span class="md-ellipsis"> Changelog </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2"> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../API/" class="md-nav__link"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a href="../REALTIME/" class="md-nav__link"> <span class="md-ellipsis"> Real-Time </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3"> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../USER-GUIDE/" class="md-nav__link"> <span class="md-ellipsis"> User Guide </span> </a> </li> <li class="md-nav__item"> <a href="../DEVELOPER-GUIDE/" class="md-nav__link"> <span class="md-ellipsis"> Developer Guide </span> </a> </li> <li class="md-nav__item"> <a href="../AI-FEATURES/" class="md-nav__link"> <span class="md-ellipsis"> AI Features </span> </a> </li> <li class="md-nav__item"> <a href="../ADMIN/" class="md-nav__link"> <span class="md-ellipsis"> Admin Dashboard </span> </a> </li> <li class="md-nav__item"> <a href="../COMPONENTS/" class="md-nav__link"> <span class="md-ellipsis"> Components </span> </a> </li> <li class="md-nav__item"> <a href="../TESTING/" class="md-nav__link"> <span class="md-ellipsis"> Testing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4"> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0"> <span class="md-ellipsis"> SDKs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> SDKs </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../sdks/" class="md-nav__link"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a href="../sdks/python/" class="md-nav__link"> <span class="md-ellipsis"> Python </span> </a> </li> <li class="md-nav__item"> <a href="../sdks/javascript/" class="md-nav__link"> <span class="md-ellipsis"> JavaScript </span> </a> </li> <li class="md-nav__item"> <a href="../sdks/typescript/" class="md-nav__link"> <span class="md-ellipsis"> TypeScript </span> </a> </li> <li class="md-nav__item"> <a href="../sdks/react/" class="md-nav__link"> <span class="md-ellipsis"> React </span> </a> </li> <li class="md-nav__item"> <a href="../sdks/go/" class="md-nav__link"> <span class="md-ellipsis"> Go </span> </a> </li> <li class="md-nav__item"> <a href="../sdks/php/" class="md-nav__link"> <span class="md-ellipsis"> PHP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5"> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../integrations/" class="md-nav__link"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a href="../integrations/mcp/" class="md-nav__link"> <span class="md-ellipsis"> MCP Server </span> </a> </li> <li class="md-nav__item"> <a href="../integrations/chatgpt/" class="md-nav__link"> <span class="md-ellipsis"> ChatGPT Plugin </span> </a> </li> <li class="md-nav__item"> <a href="../integrations/extension/" class="md-nav__link"> <span class="md-ellipsis"> Browser Extension </span> </a> </li> <li class="md-nav__item"> <a href="../integrations/alfred/" class="md-nav__link"> <span class="md-ellipsis"> Alfred Workflow </span> </a> </li> <li class="md-nav__item"> <a href="../integrations/raycast/" class="md-nav__link"> <span class="md-ellipsis"> Raycast </span> </a> </li> <li class="md-nav__item"> <a href="../integrations/widgets/" class="md-nav__link"> <span class="md-ellipsis"> Widgets </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6"> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../examples/" class="md-nav__link"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a href="../examples/discord/" class="md-nav__link"> <span class="md-ellipsis"> Discord Bot </span> </a> </li> <li class="md-nav__item"> <a href="../examples/slack/" class="md-nav__link"> <span class="md-ellipsis"> Slack Bot </span> </a> </li> <li class="md-nav__item"> <a href="../examples/telegram/" class="md-nav__link"> <span class="md-ellipsis"> Telegram Bot </span> </a> </li> <li class="md-nav__item"> <a href="../examples/langchain/" class="md-nav__link"> <span class="md-ellipsis"> LangChain </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7"> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> Deployment </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../DEPLOYMENT/" class="md-nav__link"> <span class="md-ellipsis"> Self-Hosting </span> </a> </li> <li class="md-nav__item"> <a href="../ARCHITECTURE/" class="md-nav__link"> <span class="md-ellipsis"> Architecture </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8"> <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0"> <span class="md-ellipsis"> Community </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> Community </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../CONTRIBUTING/" class="md-nav__link"> <span class="md-ellipsis"> Contributing </span> </a> </li> <li class="md-nav__item"> <a href="../SECURITY/" class="md-nav__link"> <span class="md-ellipsis"> Security </span> </a> </li> <li class="md-nav__item"> <a href="../AGENT-PROMPTS/" class="md-nav__link"> <span class="md-ellipsis"> Agent Prompts </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#table-of-contents" class="md-nav__link"> <span class="md-ellipsis"> Table of Contents </span> </a> </li> <li class="md-nav__item"> <a href="#section-1-api-endpoint-matrix" class="md-nav__link"> <span class="md-ellipsis"> Section 1: API Endpoint Matrix </span> </a> <nav class="md-nav" aria-label="Section 1: API Endpoint Matrix"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#11-core-api-routes-both-projects" class="md-nav__link"> <span class="md-ellipsis"> 1.1 Core API Routes (Both Projects) </span> </a> </li> <li class="md-nav__item"> <a href="#12-fcn-unique-api-routes" class="md-nav__link"> <span class="md-ellipsis"> 1.2 FCN-Unique API Routes </span> </a> </li> <li class="md-nav__item"> <a href="#13-cda-unique-api-routes" class="md-nav__link"> <span class="md-ellipsis"> 1.3 CDA-Unique API Routes </span> </a> </li> <li class="md-nav__item"> <a href="#14-premium-api-comparison" class="md-nav__link"> <span class="md-ellipsis"> 1.4 Premium API Comparison </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#section-2-library-comparison" class="md-nav__link"> <span class="md-ellipsis"> Section 2: Library Comparison </span> </a> <nav class="md-nav" aria-label="Section 2: Library Comparison"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21-core-utilities-both-projects" class="md-nav__link"> <span class="md-ellipsis"> 2.1 Core Utilities (Both Projects) </span> </a> </li> <li class="md-nav__item"> <a href="#22-fcn-unique-utilities" class="md-nav__link"> <span class="md-ellipsis"> 2.2 FCN-Unique Utilities </span> </a> </li> <li class="md-nav__item"> <a href="#23-cda-unique-utilities" class="md-nav__link"> <span class="md-ellipsis"> 2.3 CDA-Unique Utilities </span> </a> </li> <li class="md-nav__item"> <a href="#24-library-implementation-differences" class="md-nav__link"> <span class="md-ellipsis"> 2.4 Library Implementation Differences </span> </a> <nav class="md-nav" aria-label="2.4 Library Implementation Differences"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#admin-authentication" class="md-nav__link"> <span class="md-ellipsis"> Admin Authentication </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#section-3-data-fetching-patterns" class="md-nav__link"> <span class="md-ellipsis"> Section 3: Data Fetching Patterns </span> </a> <nav class="md-nav" aria-label="Section 3: Data Fetching Patterns"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31-rss-fetching-comparison" class="md-nav__link"> <span class="md-ellipsis"> 3.1 RSS Fetching Comparison </span> </a> </li> <li class="md-nav__item"> <a href="#32-market-data-fetching-comparison" class="md-nav__link"> <span class="md-ellipsis"> 3.2 Market Data Fetching Comparison </span> </a> </li> <li class="md-nav__item"> <a href="#33-ai-integration-comparison" class="md-nav__link"> <span class="md-ellipsis"> 3.3 AI Integration Comparison </span> </a> </li> <li class="md-nav__item"> <a href="#34-websocket-handling-comparison" class="md-nav__link"> <span class="md-ellipsis"> 3.4 WebSocket Handling Comparison </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#section-4-caching-strategies" class="md-nav__link"> <span class="md-ellipsis"> Section 4: Caching Strategies </span> </a> <nav class="md-nav" aria-label="Section 4: Caching Strategies"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41-layer-comparison" class="md-nav__link"> <span class="md-ellipsis"> 4.1 Layer Comparison </span> </a> </li> <li class="md-nav__item"> <a href="#42-cache-ttl-configuration" class="md-nav__link"> <span class="md-ellipsis"> 4.2 Cache TTL Configuration </span> </a> </li> <li class="md-nav__item"> <a href="#43-http-cache-headers" class="md-nav__link"> <span class="md-ellipsis"> 4.3 HTTP Cache Headers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#section-5-authenticationauthorization" class="md-nav__link"> <span class="md-ellipsis"> Section 5: Authentication/Authorization </span> </a> <nav class="md-nav" aria-label="Section 5: Authentication/Authorization"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#51-premium-access-control" class="md-nav__link"> <span class="md-ellipsis"> 5.1 Premium Access Control </span> </a> </li> <li class="md-nav__item"> <a href="#52-admin-authentication" class="md-nav__link"> <span class="md-ellipsis"> 5.2 Admin Authentication </span> </a> </li> <li class="md-nav__item"> <a href="#53-api-key-management" class="md-nav__link"> <span class="md-ellipsis"> 5.3 API Key Management </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#section-6-external-api-integrations" class="md-nav__link"> <span class="md-ellipsis"> Section 6: External API Integrations </span> </a> <nav class="md-nav" aria-label="Section 6: External API Integrations"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#61-api-usage-matrix" class="md-nav__link"> <span class="md-ellipsis"> 6.1 API Usage Matrix </span> </a> </li> <li class="md-nav__item"> <a href="#62-websocket-connections" class="md-nav__link"> <span class="md-ellipsis"> 6.2 WebSocket Connections </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#section-7-migration-plan" class="md-nav__link"> <span class="md-ellipsis"> Section 7: Migration Plan </span> </a> <nav class="md-nav" aria-label="Section 7: Migration Plan"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#71-apis-to-add-to-fcn-from-cda" class="md-nav__link"> <span class="md-ellipsis"> 7.1 APIs to Add to FCN from CDA </span> </a> </li> <li class="md-nav__item"> <a href="#72-apis-to-add-to-cda-from-fcn" class="md-nav__link"> <span class="md-ellipsis"> 7.2 APIs to Add to CDA from FCN </span> </a> </li> <li class="md-nav__item"> <a href="#73-utility-functions-to-share" class="md-nav__link"> <span class="md-ellipsis"> 7.3 Utility Functions to Share </span> </a> </li> <li class="md-nav__item"> <a href="#74-code-migration-snippets" class="md-nav__link"> <span class="md-ellipsis"> 7.4 Code Migration Snippets </span> </a> <nav class="md-nav" aria-label="7.4 Code Migration Snippets"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#adding-admin-auth-to-fcn" class="md-nav__link"> <span class="md-ellipsis"> Adding Admin Auth to FCN </span> </a> </li> <li class="md-nav__item"> <a href="#adding-register-api-to-fcn" class="md-nav__link"> <span class="md-ellipsis"> Adding Register API to FCN </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#summary" class="md-nav__link"> <span class="md-ellipsis"> Summary </span> </a> <nav class="md-nav" aria-label="Summary"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#key-findings" class="md-nav__link"> <span class="md-ellipsis"> Key Findings </span> </a> </li> <li class="md-nav__item"> <a href="#recommended-actions" class="md-nav__link"> <span class="md-ellipsis"> Recommended Actions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="api-routes-and-backend-logic-comparison">API Routes and Backend Logic Comparison<a class="headerlink" href="#api-routes-and-backend-logic-comparison" title="Link to this section">¶</a></h1> <p><strong>FCN (Free Crypto News)</strong> vs <strong>CDA (Crypto Data Aggregator)</strong></p> <blockquote> <p>Generated: January 24, 2026 Purpose: Document differences between FCN and CDA API routes and backend utilities</p> <p><strong>Status: ✅ COMPLETE</strong> - All CDA-unique APIs have been migrated to FCN</p> </blockquote> <hr> <h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this section">¶</a></h2> <ol> <li><a href="#section-1-api-endpoint-matrix">API Endpoint Matrix</a></li> <li><a href="#section-2-library-comparison">Library Comparison</a></li> <li><a href="#section-3-data-fetching-patterns">Data Fetching Patterns</a></li> <li><a href="#section-4-caching-strategies">Caching Strategies</a></li> <li><a href="#section-5-authenticationauthorization">Authentication/Authorization</a></li> <li><a href="#section-6-external-api-integrations">External API Integrations</a></li> <li><a href="#section-7-migration-plan">Migration Plan</a></li> </ol> <hr> <h2 id="section-1-api-endpoint-matrix">Section 1: API Endpoint Matrix<a class="headerlink" href="#section-1-api-endpoint-matrix" title="Link to this section">¶</a></h2> <h3 id="11-core-api-routes-both-projects">1.1 Core API Routes (Both Projects)<a class="headerlink" href="#11-core-api-routes-both-projects" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Endpoint</th> <th>FCN</th> <th>CDA</th> <th>Method</th> <th>Purpose</th> <th>Differences</th> </tr> </thead> <tbody> <tr> <td><code>/api/admin</code></td> <td>✅</td> <td>✅</td> <td>GET, POST</td> <td>Admin dashboard stats</td> <td>CDA uses centralized <code>requireAdminAuth</code>, FCN uses inline auth</td> </tr> <tr> <td><code>/api/ai</code></td> <td>✅</td> <td>✅</td> <td>GET, POST</td> <td>AI content analysis</td> <td>Identical implementation</td> </tr> <tr> <td><code>/api/ai/brief</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>AI news brief</td> <td>Identical</td> </tr> <tr> <td><code>/api/ai/counter</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Counter-argument AI</td> <td>Identical</td> </tr> <tr> <td><code>/api/ai/debate</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>AI debate mode</td> <td>Identical</td> </tr> <tr> <td><code>/api/alerts</code></td> <td>✅</td> <td>✅</td> <td>GET, POST</td> <td>Alert management</td> <td>Identical</td> </tr> <tr> <td><code>/api/alerts/[id]</code></td> <td>✅</td> <td>✅</td> <td>GET, PUT, DELETE</td> <td>Single alert CRUD</td> <td>Identical</td> </tr> <tr> <td><code>/api/analytics/*</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Analytics endpoints</td> <td>Identical (anomalies, credibility, headlines)</td> </tr> <tr> <td><code>/api/analyze</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Content analysis</td> <td>Identical</td> </tr> <tr> <td><code>/api/archive</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Historical archive</td> <td>Identical</td> </tr> <tr> <td><code>/api/archive/v2</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>V2 archive format</td> <td>Identical</td> </tr> <tr> <td><code>/api/article</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Single article fetch</td> <td>Identical</td> </tr> <tr> <td><code>/api/ask</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>AI Q&amp;A</td> <td>Identical</td> </tr> <tr> <td><code>/api/atom</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Atom feed</td> <td>Identical</td> </tr> <tr> <td><code>/api/bitcoin</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Bitcoin news filter</td> <td>Identical</td> </tr> <tr> <td><code>/api/breaking</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Breaking news</td> <td>Identical</td> </tr> <tr> <td><code>/api/cache</code></td> <td>✅</td> <td>✅</td> <td>GET, DELETE</td> <td>Cache management</td> <td>Identical</td> </tr> <tr> <td><code>/api/charts</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Chart data</td> <td>Identical</td> </tr> <tr> <td><code>/api/claims</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Claim extraction</td> <td>Identical</td> </tr> <tr> <td><code>/api/classify</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Content classification</td> <td>Identical</td> </tr> <tr> <td><code>/api/clickbait</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Clickbait detection</td> <td>Identical</td> </tr> <tr> <td><code>/api/defi</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>DeFi news filter</td> <td>Identical</td> </tr> <tr> <td><code>/api/digest</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Daily digest</td> <td>Identical</td> </tr> <tr> <td><code>/api/docs</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>API documentation</td> <td>Identical</td> </tr> <tr> <td><code>/api/entities</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Entity extraction</td> <td>Identical</td> </tr> <tr> <td><code>/api/factcheck</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Fact checking</td> <td>Identical</td> </tr> <tr> <td><code>/api/gateway</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>API gateway</td> <td>Identical</td> </tr> <tr> <td><code>/api/health</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Health check</td> <td><strong>Identical</strong> - both check 7 RSS sources</td> </tr> <tr> <td><code>/api/market/*</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Market data</td> <td>14 sub-routes, identical</td> </tr> <tr> <td><code>/api/narratives</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Narrative tracking</td> <td>Identical</td> </tr> <tr> <td><code>/api/news</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Main news endpoint</td> <td><strong>Identical</strong> - translation support</td> </tr> <tr> <td><code>/api/newsletter</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Newsletter signup</td> <td>Identical</td> </tr> <tr> <td><code>/api/og</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>OG image generation</td> <td>Identical (TSX route)</td> </tr> <tr> <td><code>/api/opml</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>OPML export</td> <td>Identical</td> </tr> <tr> <td><code>/api/origins</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Source origins</td> <td>Identical</td> </tr> <tr> <td><code>/api/portfolio/*</code></td> <td>✅</td> <td>✅</td> <td>GET, POST</td> <td>Portfolio management</td> <td>Identical</td> </tr> <tr> <td><code>/api/premium/*</code></td> <td>✅</td> <td>✅</td> <td>Various</td> <td>Premium features</td> <td>Identical structure (13 routes)</td> </tr> <tr> <td><code>/api/push</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Push notifications</td> <td>Identical</td> </tr> <tr> <td><code>/api/rss</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>RSS feed</td> <td>Identical</td> </tr> <tr> <td><code>/api/search</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>News search</td> <td>Identical</td> </tr> <tr> <td><code>/api/sentiment</code></td> <td>✅</td> <td>✅</td> <td>GET, POST</td> <td>Sentiment analysis</td> <td>Identical</td> </tr> <tr> <td><code>/api/signals</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Trading signals</td> <td>Identical</td> </tr> <tr> <td><code>/api/sources</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Source listing</td> <td>Identical</td> </tr> <tr> <td><code>/api/sse</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Server-sent events</td> <td>Identical</td> </tr> <tr> <td><code>/api/stats</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Statistics</td> <td>Identical</td> </tr> <tr> <td><code>/api/summarize</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Content summarization</td> <td>Identical</td> </tr> <tr> <td><code>/api/trending</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Trending topics</td> <td>Identical</td> </tr> <tr> <td><code>/api/upgrade</code></td> <td>✅</td> <td>✅</td> <td>POST</td> <td>Plan upgrade</td> <td>Identical</td> </tr> <tr> <td><code>/api/v1/*</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>Versioned API</td> <td>See differences below</td> </tr> <tr> <td><code>/api/webhooks</code></td> <td>✅</td> <td>✅</td> <td>GET, POST</td> <td>Webhook management</td> <td>Identical</td> </tr> <tr> <td><code>/api/ws</code></td> <td>✅</td> <td>✅</td> <td>GET</td> <td>WebSocket endpoint</td> <td>Identical</td> </tr> </tbody> </table> <h3 id="12-fcn-unique-api-routes">1.2 FCN-Unique API Routes<a class="headerlink" href="#12-fcn-unique-api-routes" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Endpoint</th> <th>Method</th> <th>Purpose</th> <th>Details</th> </tr> </thead> <tbody> <tr> <td><code>/api/i18n/translate</code></td> <td>POST</td> <td>On-demand translation</td> <td>Groq-powered translation for dynamic content. Supports single text or batch translations to 18 locales</td> </tr> <tr> <td><code>/api/news/international</code></td> <td>GET</td> <td>International news</td> <td>Fetches from Korean, Chinese, Japanese, Spanish sources with optional translation</td> </tr> <tr> <td><code>/api/openapi.json</code></td> <td>GET</td> <td>OpenAPI spec</td> <td>Returns complete OpenAPI 3.1.0 specification for API documentation/integrations</td> </tr> </tbody> </table> <p><strong><code>/api/i18n/translate</code> Details:</strong> - <strong>Authentication</strong>: None (relies on Groq API key) - <strong>Rate limit</strong>: Subject to Groq limits - <strong>Request format</strong>: </p><div class="language-json highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello world"</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="nt">"targetLocale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"es"</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">"context"</span><span class="p">:</span><span class="w"> </span><span class="s2">"button label"</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">}</span>
</span></code></pre></div> - <strong>Batch format</strong>: <div class="language-json highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="nt">"texts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"key1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello"</span><span class="p">,</span><span class="w"> </span><span class="nt">"key2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"World"</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="nt">"targetLocale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"es"</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">}</span>
</span></code></pre></div><p></p> <p><strong><code>/api/news/international</code> Details:</strong> - <strong>Parameters</strong>: <code>language</code> (ko|zh|ja|es|all), <code>translate</code> (bool), <code>limit</code>, <code>region</code> (asia|europe|latam|all) - <strong>Caching</strong>: 5 minutes (revalidate=300) - <strong>Runtime</strong>: Edge</p> <h3 id="13-cda-unique-api-routes">1.3 CDA-Unique API Routes<a class="headerlink" href="#13-cda-unique-api-routes" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Endpoint</th> <th>Method</th> <th>Purpose</th> <th>Details</th> </tr> </thead> <tbody> <tr> <td><code>/api/admin/keys</code></td> <td>GET, PATCH</td> <td>Admin API key management</td> <td>List, filter, sort, paginate API keys; revoke/activate/upgrade keys</td> </tr> <tr> <td><code>/api/admin/stats</code></td> <td>GET</td> <td>Admin statistics</td> <td>Comprehensive key usage stats, tier breakdown, top users, usage history</td> </tr> <tr> <td><code>/api/cron/expire-subscriptions</code></td> <td>GET, POST</td> <td>Subscription expiry cron</td> <td>Auto-downgrade expired pro/enterprise keys to free tier</td> </tr> <tr> <td><code>/api/register</code></td> <td>GET, POST</td> <td>API key registration</td> <td>Self-service free API key creation (max 3 per email)</td> </tr> <tr> <td><code>/api/v1/usage</code></td> <td>GET</td> <td>Usage statistics</td> <td>Get API key usage stats (today, month, limits, remaining)</td> </tr> <tr> <td><code>/api/webhooks/test</code></td> <td>GET, POST</td> <td>Webhook testing</td> <td>Test webhook delivery, verification documentation</td> </tr> </tbody> </table> <p><strong><code>/api/admin/keys</code> Details:</strong> - <strong>Authentication</strong>: Admin token via Bearer or X-Admin-Key header - <strong>GET Query Params</strong>: page, limit, search, tier, status, sortBy, sortOrder - <strong>PATCH Actions</strong>: revoke, activate, upgrade (with tier change)</p> <p><strong><code>/api/admin/stats</code> Details:</strong> - Returns tier breakdown, active key counts (24h/7d/30d), top 10 keys, 30-day usage history - <strong>Response includes</strong>: total keys, requests today/month, usage by day chart data</p> <p><strong><code>/api/cron/expire-subscriptions</code> Details:</strong> - <strong>Security</strong>: CRON_SECRET environment variable (Authorization: Bearer or query param) - <strong>Max Duration</strong>: 60 seconds - Scans for expired subscriptions, auto-downgrades to free tier</p> <p><strong><code>/api/register</code> Details:</strong> - <strong>Public endpoint</strong> - no auth required - <strong>POST body</strong>: <code>{ email, name?, action? }</code> - <strong>Actions</strong>: Create key (default), list keys, revoke key - <strong>Limits</strong>: Max 3 keys per email</p> <p><strong><code>/api/v1/usage</code> Details:</strong> - <strong>Authentication</strong>: X-API-Key header or api_key query param - <strong>Returns</strong>: tier, usageToday, usageMonth, limit, remaining, resetAt, keyInfo - <strong>Rate limit headers</strong>: X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset</p> <h3 id="14-premium-api-comparison">1.4 Premium API Comparison<a class="headerlink" href="#14-premium-api-comparison" title="Link to this section">¶</a></h3> <p>Both projects share identical premium API structure with X402 micropayment integration:</p> <table> <thead> <tr> <th>Premium Endpoint</th> <th>Price</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><code>/api/premium/ai/analyze</code></td> <td>$0.05</td> <td>AI-powered market analysis</td> </tr> <tr> <td><code>/api/premium/ai/compare</code></td> <td>$0.05</td> <td>Multi-coin AI comparison</td> </tr> <tr> <td><code>/api/premium/ai/sentiment</code></td> <td>$0.05</td> <td>AI sentiment analysis</td> </tr> <tr> <td><code>/api/premium/ai/signals</code></td> <td>$0.05</td> <td>AI trading signals</td> </tr> <tr> <td><code>/api/premium/ai/summary</code></td> <td>$0.03</td> <td>AI content summary</td> </tr> <tr> <td><code>/api/premium/alerts/custom</code></td> <td>$0.02</td> <td>Custom alert rules</td> </tr> <tr> <td><code>/api/premium/alerts/whales</code></td> <td>$0.05</td> <td>Whale alert subscription</td> </tr> <tr> <td><code>/api/premium/analytics/screener</code></td> <td>$0.05</td> <td>Advanced screener</td> </tr> <tr> <td><code>/api/premium/api-keys</code></td> <td>-</td> <td>API key management</td> </tr> <tr> <td><code>/api/premium/defi/protocols</code></td> <td>$0.05</td> <td>DeFi protocol data</td> </tr> <tr> <td><code>/api/premium/export/portfolio</code></td> <td>$0.10</td> <td>Portfolio export</td> </tr> <tr> <td><code>/api/premium/market/coins</code></td> <td>$0.02</td> <td>Premium coin data</td> </tr> <tr> <td><code>/api/premium/market/history</code></td> <td>$0.03</td> <td>Extended history</td> </tr> <tr> <td><code>/api/premium/portfolio/analytics</code></td> <td>$0.10</td> <td>Portfolio analytics</td> </tr> <tr> <td><code>/api/premium/screener/advanced</code></td> <td>$0.05</td> <td>Advanced screener</td> </tr> <tr> <td><code>/api/premium/smart-money</code></td> <td>$0.05</td> <td>Smart money tracking</td> </tr> <tr> <td><code>/api/premium/streams/prices</code></td> <td>$0.01/min</td> <td>Live price streams</td> </tr> <tr> <td><code>/api/premium/whales/alerts</code></td> <td>$0.05</td> <td>Whale alert config</td> </tr> <tr> <td><code>/api/premium/whales/transactions</code></td> <td>$0.05</td> <td>Whale transaction data</td> </tr> </tbody> </table> <p><strong>Implementation</strong>: Both use <code>withX402</code> middleware from <code>@x402/next</code> or <code>@/lib/x402-middleware</code></p> <hr> <h2 id="section-2-library-comparison">Section 2: Library Comparison<a class="headerlink" href="#section-2-library-comparison" title="Link to this section">¶</a></h2> <h3 id="21-core-utilities-both-projects">2.1 Core Utilities (Both Projects)<a class="headerlink" href="#21-core-utilities-both-projects" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Utility</th> <th>FCN</th> <th>CDA</th> <th>Purpose</th> <th>Differences</th> </tr> </thead> <tbody> <tr> <td><code>api-keys.ts</code></td> <td>✅ (701 lines)</td> <td>✅ (~650 lines)</td> <td>API key management</td> <td><strong>Identical</strong> - Both use Vercel KV, same tier structure, Edge-compatible crypto</td> </tr> <tr> <td><code>api-utils.ts</code></td> <td>✅</td> <td>✅</td> <td>Response helpers</td> <td>Identical</td> </tr> <tr> <td><code>cache.ts</code></td> <td>✅ (175 lines)</td> <td>✅ (~175 lines)</td> <td>In-memory cache</td> <td><strong>Identical</strong> - Same TTL-based MemoryCache class</td> </tr> <tr> <td><code>crypto-news.ts</code></td> <td>✅ (591 lines)</td> <td>✅ (~600 lines)</td> <td>RSS aggregation</td> <td><strong>Identical</strong> - 12 sources, same parsing</td> </tr> <tr> <td><code>market-data.ts</code></td> <td>✅ (1837 lines)</td> <td>✅ (~1800 lines)</td> <td>Market data service</td> <td><strong>Identical</strong> - CoinGecko, DeFiLlama, Alternative.me</td> </tr> <tr> <td><code>rate-limit.ts</code></td> <td>✅ (155 lines)</td> <td>✅ (~155 lines)</td> <td>Rate limiting</td> <td><strong>Identical</strong> - In-memory, 60 req/min, same middleware</td> </tr> <tr> <td><code>external-apis.ts</code></td> <td>✅ (316 lines)</td> <td>✅ (~316 lines)</td> <td>External API config</td> <td><strong>CDA has more</strong> - WebSocket URLs, additional exchanges</td> </tr> <tr> <td><code>groq.ts</code></td> <td>✅</td> <td>✅</td> <td>Groq AI integration</td> <td>Identical</td> </tr> <tr> <td><code>translate.ts</code></td> <td>✅</td> <td>✅</td> <td>Translation service</td> <td>Identical</td> </tr> <tr> <td><code>webhooks.ts</code></td> <td>✅</td> <td>✅</td> <td>Webhook handling</td> <td>Identical</td> </tr> <tr> <td><code>premium-ai.ts</code></td> <td>✅</td> <td>✅</td> <td>Premium AI logic</td> <td>Identical</td> </tr> <tr> <td><code>premium-whales.ts</code></td> <td>✅</td> <td>✅</td> <td>Whale tracking</td> <td>Identical</td> </tr> <tr> <td><code>premium-screener.ts</code></td> <td>✅</td> <td>✅</td> <td>Advanced screener</td> <td>Identical</td> </tr> <tr> <td><code>x402.ts</code> + related</td> <td>✅ (5 files)</td> <td>✅ (5 files)</td> <td>X402 micropayments</td> <td>Identical</td> </tr> </tbody> </table> <h3 id="22-fcn-unique-utilities">2.2 FCN-Unique Utilities<a class="headerlink" href="#22-fcn-unique-utilities" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Utility</th> <th>Lines</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><code>international-sources.ts</code></td> <td>612</td> <td>Korean, Chinese, Japanese, Spanish news sources</td> </tr> <tr> <td><code>source-translator.ts</code></td> <td>~300</td> <td>Translation for international sources</td> </tr> <tr> <td><code>alpha-signal-engine.ts</code></td> <td>~200</td> <td>Alpha signal generation (experimental)</td> </tr> <tr> <td><code>bitcoin-onchain.ts</code></td> <td>-</td> <td>Bitcoin on-chain data (in CDA external-apis)</td> </tr> <tr> <td><code>coincap.ts</code></td> <td>-</td> <td>CoinCap API wrapper (separate file)</td> </tr> <tr> <td><code>coinpaprika.ts</code></td> <td>-</td> <td>CoinPaprika API wrapper (separate file)</td> </tr> <tr> <td><code>defi-yields.ts</code></td> <td>-</td> <td>DeFi yield data (moved to external-apis in CDA)</td> </tr> <tr> <td><code>license-check.ts</code></td> <td>-</td> <td>License validation</td> </tr> <tr> <td><code>category-icons.ts</code></td> <td>-</td> <td>Category icon mappings</td> </tr> </tbody> </table> <h3 id="23-cda-unique-utilities">2.3 CDA-Unique Utilities<a class="headerlink" href="#23-cda-unique-utilities" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Utility</th> <th>Lines</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><code>admin-auth.ts</code></td> <td>140</td> <td><strong>Centralized admin authentication</strong> - secure token comparison, multiple header support</td> </tr> </tbody> </table> <h3 id="24-library-implementation-differences">2.4 Library Implementation Differences<a class="headerlink" href="#24-library-implementation-differences" title="Link to this section">¶</a></h3> <h4 id="admin-authentication">Admin Authentication<a class="headerlink" href="#admin-authentication" title="Link to this section">¶</a></h4> <p><strong>FCN</strong> (<code>/api/admin/route.ts</code> inline): </p><div class="language-typescript highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">ADMIN_TOKEN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ADMIN_TOKEN</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">'dev-admin-token'</span><span class="p">;</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kd">function</span><span class="w"> </span><span class="nx">isAuthorized</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">authHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'Authorization'</span><span class="p">);</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">authHeader</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">authHeader</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'Bearer '</span><span class="p">,</span><span class="w"> </span><span class="s1">''</span><span class="p">);</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">token</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">ADMIN_TOKEN</span><span class="p">;</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">}</span>
</span></code></pre></div><p></p> <p><strong>CDA</strong> (<code>lib/admin-auth.ts</code>): </p><div class="language-typescript highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// Constant-time comparison to prevent timing attacks</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kd">function</span><span class="w"> </span><span class="nx">secureCompare</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="nx">result</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="p">}</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="c1">// Multiple header support</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="kd">function</span><span class="w"> </span><span class="nx">extractToken</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">authHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'Authorization'</span><span class="p">);</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">authHeader</span><span class="o">?</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">'Bearer '</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">authHeader</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">7</span><span class="p">);</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">adminKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'X-Admin-Key'</span><span class="p">);</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">adminKey</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">adminKey</span><span class="p">;</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="p">}</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="c1">// Reusable middleware</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">requireAdminAuth</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NextResponse</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div><p></p> <p><strong>Key Improvements in CDA</strong>: - ✅ Timing-attack resistant comparison - ✅ Multiple header support (Authorization Bearer, X-Admin-Key) - ✅ Production-safe (no fallback token in production) - ✅ Reusable middleware function - ✅ Centralized error responses</p> <hr> <h2 id="section-3-data-fetching-patterns">Section 3: Data Fetching Patterns<a class="headerlink" href="#section-3-data-fetching-patterns" title="Link to this section">¶</a></h2> <h3 id="31-rss-fetching-comparison">3.1 RSS Fetching Comparison<a class="headerlink" href="#31-rss-fetching-comparison" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Aspect</th> <th>FCN</th> <th>CDA</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td>Sources</td> <td>12 RSS feeds</td> <td>12 RSS feeds</td> <td>Identical</td> </tr> <tr> <td>Parsing</td> <td><code>sanitize-html</code></td> <td><code>sanitize-html</code></td> <td>Same library</td> </tr> <tr> <td>Deduplication</td> <td>Title-based hash</td> <td>Title-based hash</td> <td>Same algorithm</td> </tr> <tr> <td>Caching</td> <td>In-memory + revalidate</td> <td>In-memory + revalidate</td> <td>Identical</td> </tr> <tr> <td>Error handling</td> <td>Per-source fallback</td> <td>Per-source fallback</td> <td>Identical</td> </tr> <tr> <td>International</td> <td>✅ (separate module)</td> <td>❌</td> <td>FCN has 20+ intl sources</td> </tr> </tbody> </table> <h3 id="32-market-data-fetching-comparison">3.2 Market Data Fetching Comparison<a class="headerlink" href="#32-market-data-fetching-comparison" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Aspect</th> <th>FCN</th> <th>CDA</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td>CoinGecko</td> <td>✅</td> <td>✅</td> <td>Identical implementation</td> </tr> <tr> <td>DeFiLlama</td> <td>✅</td> <td>✅</td> <td>Identical implementation</td> </tr> <tr> <td>Alternative.me</td> <td>✅</td> <td>✅</td> <td>Fear/Greed index</td> </tr> <tr> <td>CoinCap</td> <td>✅ (separate file)</td> <td>✅ (in external-apis)</td> <td>Same functionality</td> </tr> <tr> <td>CoinPaprika</td> <td>✅ (separate file)</td> <td>✅ (in external-apis)</td> <td>Same functionality</td> </tr> <tr> <td>Cache TTLs</td> <td>Identical</td> <td>Identical</td> <td>30s-3600s based on data type</td> </tr> </tbody> </table> <h3 id="33-ai-integration-comparison">3.3 AI Integration Comparison<a class="headerlink" href="#33-ai-integration-comparison" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Aspect</th> <th>FCN</th> <th>CDA</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td>Provider</td> <td>Groq (llama-3.3-70b)</td> <td>Groq (llama-3.3-70b)</td> <td>Identical</td> </tr> <tr> <td>Streaming</td> <td>✅</td> <td>✅</td> <td>Same implementation</td> </tr> <tr> <td>JSON parsing</td> <td><code>parseGroqJson</code></td> <td><code>parseGroqJson</code></td> <td>Identical helper</td> </tr> <tr> <td>Error handling</td> <td>Graceful fallback</td> <td>Graceful fallback</td> <td>Identical</td> </tr> </tbody> </table> <h3 id="34-websocket-handling-comparison">3.4 WebSocket Handling Comparison<a class="headerlink" href="#34-websocket-handling-comparison" title="Link to this section">¶</a></h3> <p>Both use <code>price-websocket.ts</code> and <code>websocket.ts</code> with identical implementation: - CoinCap WebSocket for real-time prices - Custom SSE fallback for non-WebSocket environments - Same reconnection logic</p> <hr> <h2 id="section-4-caching-strategies">Section 4: Caching Strategies<a class="headerlink" href="#section-4-caching-strategies" title="Link to this section">¶</a></h2> <h3 id="41-layer-comparison">4.1 Layer Comparison<a class="headerlink" href="#41-layer-comparison" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Layer</th> <th>FCN Approach</th> <th>CDA Approach</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td>HTTP Cache</td> <td><code>Cache-Control</code> headers</td> <td><code>Cache-Control</code> headers</td> <td>Identical patterns</td> </tr> <tr> <td>Edge Revalidation</td> <td><code>revalidate</code> export</td> <td><code>revalidate</code> export</td> <td>Next.js ISR</td> </tr> <tr> <td>In-Memory</td> <td><code>MemoryCache</code> class</td> <td><code>MemoryCache</code> class</td> <td><strong>Identical</strong> implementation</td> </tr> <tr> <td>Vercel KV</td> <td>API keys, usage</td> <td>API keys, usage</td> <td>Same patterns</td> </tr> <tr> <td>Redis (optional)</td> <td>Mentioned in comments</td> <td>Mentioned in comments</td> <td>Not implemented</td> </tr> </tbody> </table> <h3 id="42-cache-ttl-configuration">4.2 Cache TTL Configuration<a class="headerlink" href="#42-cache-ttl-configuration" title="Link to this section">¶</a></h3> <div class="language-typescript highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">// Both projects use identical TTL configuration</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">CACHE_TTL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nx">prices</span><span class="o">:</span><span class="w"> </span><span class="kt">30</span><span class="p">,</span><span class="w">           </span><span class="c1">// Live prices - 30 seconds</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nx">historical_1d</span><span class="o">:</span><span class="w"> </span><span class="kt">60</span><span class="p">,</span><span class="w">    </span><span class="c1">// 24h data - 1 minute</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span><span class="nx">historical_7d</span><span class="o">:</span><span class="w"> </span><span class="kt">300</span><span class="p">,</span><span class="w">   </span><span class="c1">// Weekly data - 5 minutes</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="nx">historical_30d</span><span class="o">:</span><span class="w"> </span><span class="kt">900</span><span class="p">,</span><span class="w">  </span><span class="c1">// Monthly data - 15 minutes</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span><span class="nx">historical_90d</span><span class="o">:</span><span class="w"> </span><span class="kt">1800</span><span class="p">,</span><span class="w"> </span><span class="c1">// 90+ days - 30 minutes</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">  </span><span class="nx">tickers</span><span class="o">:</span><span class="w"> </span><span class="kt">120</span><span class="p">,</span><span class="w">         </span><span class="c1">// Exchange data - 2 minutes</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">  </span><span class="nx">static</span><span class="o">:</span><span class="w"> </span><span class="kt">3600</span><span class="p">,</span><span class="w">         </span><span class="c1">// Categories - 1 hour</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">  </span><span class="nx">search</span><span class="o">:</span><span class="w"> </span><span class="kt">300</span><span class="p">,</span><span class="w">          </span><span class="c1">// Search results - 5 minutes</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">  </span><span class="nx">social</span><span class="o">:</span><span class="w"> </span><span class="kt">1800</span><span class="p">,</span><span class="w">         </span><span class="c1">// Dev/community - 30 minutes</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">  </span><span class="nx">global</span><span class="o">:</span><span class="w"> </span><span class="kt">300</span><span class="p">,</span><span class="w">          </span><span class="c1">// Global data - 5 minutes</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="p">};</span>
</span></code></pre></div> <h3 id="43-http-cache-headers">4.3 HTTP Cache Headers<a class="headerlink" href="#43-http-cache-headers" title="Link to this section">¶</a></h3> <div class="language-typescript highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">// Both projects use identical cache header patterns</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c1">// Standard (5 min cache, 1 min stale-while-revalidate)</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="s1">'Cache-Control'</span><span class="o">:</span><span class="w"> </span><span class="s1">'public, s-maxage=300, stale-while-revalidate=60'</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1">// Real-time (30 sec)</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="s1">'Cache-Control'</span><span class="o">:</span><span class="w"> </span><span class="s1">'public, s-maxage=30, stale-while-revalidate=10'</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c1">// Static (1 hour)</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="s1">'Cache-Control'</span><span class="o">:</span><span class="w"> </span><span class="s1">'public, s-maxage=3600, stale-while-revalidate=300'</span>
</span></code></pre></div> <hr> <h2 id="section-5-authenticationauthorization">Section 5: Authentication/Authorization<a class="headerlink" href="#section-5-authenticationauthorization" title="Link to this section">¶</a></h2> <h3 id="51-premium-access-control">5.1 Premium Access Control<a class="headerlink" href="#51-premium-access-control" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Aspect</th> <th>FCN</th> <th>CDA</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td>Payment Protocol</td> <td>X402</td> <td>X402</td> <td>Identical</td> </tr> <tr> <td>Middleware</td> <td><code>withX402</code></td> <td><code>withX402</code></td> <td>Same implementation</td> </tr> <tr> <td>Pricing</td> <td><span class="arithmatex">\(0.01-\)</span>0.10 per request</td> <td><span class="arithmatex">\(0.01-\)</span>0.10 per request</td> <td>Identical</td> </tr> <tr> <td>Wallet Integration</td> <td>Base L2</td> <td>Base L2</td> <td>Same network</td> </tr> </tbody> </table> <h3 id="52-admin-authentication">5.2 Admin Authentication<a class="headerlink" href="#52-admin-authentication" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Aspect</th> <th>FCN</th> <th>CDA</th> </tr> </thead> <tbody> <tr> <td>Implementation</td> <td>Inline in routes</td> <td>Centralized <code>admin-auth.ts</code></td> </tr> <tr> <td>Token sources</td> <td>Authorization Bearer</td> <td>Authorization Bearer + X-Admin-Key</td> </tr> <tr> <td>Comparison</td> <td>Direct equality</td> <td>Constant-time secure comparison</td> </tr> <tr> <td>Production safety</td> <td>Fallback in prod</td> <td>No fallback in production</td> </tr> <tr> <td>Middleware</td> <td>None</td> <td><code>requireAdminAuth()</code></td> </tr> </tbody> </table> <h3 id="53-api-key-management">5.3 API Key Management<a class="headerlink" href="#53-api-key-management" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Aspect</th> <th>FCN</th> <th>CDA</th> </tr> </thead> <tbody> <tr> <td>Tiers</td> <td>free, pro, enterprise</td> <td>free, pro, enterprise</td> </tr> <tr> <td>Limits</td> <td>100 / 10,000 / unlimited</td> <td>100 / 10,000 / unlimited</td> </tr> <tr> <td>Storage</td> <td>Vercel KV</td> <td>Vercel KV</td> </tr> <tr> <td>Key format</td> <td><code>cda_free_xxx</code></td> <td><code>cda_free_xxx</code></td> </tr> <tr> <td>Registration</td> <td>❌</td> <td>✅ <code>/api/register</code></td> </tr> <tr> <td>Admin management</td> <td>❌</td> <td>✅ <code>/api/admin/keys</code>, <code>/api/admin/stats</code></td> </tr> <tr> <td>Usage tracking</td> <td>❌</td> <td>✅ <code>/api/v1/usage</code></td> </tr> <tr> <td>Expiry handling</td> <td>❌</td> <td>✅ <code>/api/cron/expire-subscriptions</code></td> </tr> </tbody> </table> <hr> <h2 id="section-6-external-api-integrations">Section 6: External API Integrations<a class="headerlink" href="#section-6-external-api-integrations" title="Link to this section">¶</a></h2> <h3 id="61-api-usage-matrix">6.1 API Usage Matrix<a class="headerlink" href="#61-api-usage-matrix" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>API</th> <th>FCN Uses</th> <th>CDA Uses</th> <th>Implementation Differences</th> </tr> </thead> <tbody> <tr> <td><strong>CoinGecko</strong></td> <td>✅</td> <td>✅</td> <td>Identical - market data, coin details, historical</td> </tr> <tr> <td><strong>DeFiLlama</strong></td> <td>✅</td> <td>✅</td> <td>Identical - TVL, protocols, yields</td> </tr> <tr> <td><strong>Alternative.me</strong></td> <td>✅</td> <td>✅</td> <td>Identical - Fear/Greed index</td> </tr> <tr> <td><strong>CoinCap</strong></td> <td>✅</td> <td>✅</td> <td>FCN: separate file, CDA: in external-apis</td> </tr> <tr> <td><strong>CoinPaprika</strong></td> <td>✅</td> <td>✅</td> <td>FCN: separate file, CDA: in external-apis</td> </tr> <tr> <td><strong>Binance</strong></td> <td>✅</td> <td>✅</td> <td>Identical - derivatives, futures data</td> </tr> <tr> <td><strong>Kraken</strong></td> <td>❌</td> <td>✅</td> <td>CDA has Kraken integration in external-apis</td> </tr> <tr> <td><strong>KuCoin</strong></td> <td>❌</td> <td>✅</td> <td>CDA has KuCoin integration</td> </tr> <tr> <td><strong>OKX</strong></td> <td>❌</td> <td>✅</td> <td>CDA has OKX integration</td> </tr> <tr> <td><strong>Bybit</strong></td> <td>❌</td> <td>✅</td> <td>CDA has Bybit integration</td> </tr> <tr> <td><strong>dYdX</strong></td> <td>❌</td> <td>✅</td> <td>CDA has dYdX integration</td> </tr> <tr> <td><strong>Deribit</strong></td> <td>❌</td> <td>✅</td> <td>CDA has Deribit integration</td> </tr> <tr> <td><strong>Mempool.space</strong></td> <td>✅</td> <td>✅</td> <td>Bitcoin on-chain data</td> </tr> <tr> <td><strong>Blockstream</strong></td> <td>✅</td> <td>✅</td> <td>Bitcoin block data</td> </tr> <tr> <td><strong>Groq</strong></td> <td>✅</td> <td>✅</td> <td>Identical - AI inference</td> </tr> <tr> <td><strong>International RSS</strong></td> <td>✅ (20+ sources)</td> <td>❌</td> <td>FCN has Korean/Chinese/Japanese/Spanish feeds</td> </tr> </tbody> </table> <h3 id="62-websocket-connections">6.2 WebSocket Connections<a class="headerlink" href="#62-websocket-connections" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>WebSocket</th> <th>FCN</th> <th>CDA</th> </tr> </thead> <tbody> <tr> <td>CoinCap Prices</td> <td>✅</td> <td>✅</td> </tr> <tr> <td>Binance Stream</td> <td>✅</td> <td>✅</td> </tr> <tr> <td>Binance Futures</td> <td>❌</td> <td>✅</td> </tr> <tr> <td>Bybit Stream</td> <td>❌</td> <td>✅</td> </tr> <tr> <td>OKX Stream</td> <td>❌</td> <td>✅</td> </tr> </tbody> </table> <hr> <h2 id="section-7-migration-plan">Section 7: Migration Plan<a class="headerlink" href="#section-7-migration-plan" title="Link to this section">¶</a></h2> <h3 id="71-apis-to-add-to-fcn-from-cda">7.1 APIs to Add to FCN from CDA<a class="headerlink" href="#71-apis-to-add-to-fcn-from-cda" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Priority</th> <th>API/Feature</th> <th>Effort</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>🔴 High</td> <td><code>/api/register</code></td> <td>Medium</td> <td>Self-service API key registration</td> </tr> <tr> <td>🔴 High</td> <td><code>/api/admin/keys</code></td> <td>Medium</td> <td>Admin API key management</td> </tr> <tr> <td>🔴 High</td> <td><code>/api/admin/stats</code></td> <td>Medium</td> <td>Usage analytics dashboard</td> </tr> <tr> <td>🟡 Medium</td> <td><code>/api/v1/usage</code></td> <td>Low</td> <td>User-facing usage stats</td> </tr> <tr> <td>🟡 Medium</td> <td><code>/api/cron/expire-subscriptions</code></td> <td>Low</td> <td>Auto-expire subscriptions</td> </tr> <tr> <td>🟡 Medium</td> <td><code>/api/webhooks/test</code></td> <td>Low</td> <td>Webhook testing utility</td> </tr> <tr> <td>🟢 Low</td> <td><code>admin-auth.ts</code> library</td> <td>Low</td> <td>Centralized secure auth</td> </tr> </tbody> </table> <h3 id="72-apis-to-add-to-cda-from-fcn">7.2 APIs to Add to CDA from FCN<a class="headerlink" href="#72-apis-to-add-to-cda-from-fcn" title="Link to this section">¶</a></h3> <table> <thead> <tr> <th>Priority</th> <th>API/Feature</th> <th>Effort</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>🔴 High</td> <td><code>/api/news/international</code></td> <td>High</td> <td>20+ international news sources</td> </tr> <tr> <td>🔴 High</td> <td><code>international-sources.ts</code></td> <td>High</td> <td>Korean/Chinese/Japanese/Spanish feeds</td> </tr> <tr> <td>🟡 Medium</td> <td><code>/api/i18n/translate</code></td> <td>Medium</td> <td>On-demand translation API</td> </tr> <tr> <td>🟡 Medium</td> <td><code>source-translator.ts</code></td> <td>Medium</td> <td>Auto-translation for news</td> </tr> <tr> <td>🟢 Low</td> <td><code>/api/openapi.json</code></td> <td>Low</td> <td>OpenAPI spec for docs/integrations</td> </tr> </tbody> </table> <h3 id="73-utility-functions-to-share">7.3 Utility Functions to Share<a class="headerlink" href="#73-utility-functions-to-share" title="Link to this section">¶</a></h3> <p>Both projects should consolidate to a shared utility package:</p> <div class="language-typescript highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">// @crypto-news/shared package structure</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nx">src</span><span class="o">/</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="nx">api</span><span class="o">-</span><span class="nx">keys</span><span class="o">/</span><span class="w">           </span><span class="c1">// API key management (both identical)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span><span class="nx">cache</span><span class="o">/</span><span class="w">              </span><span class="c1">// MemoryCache class</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="nx">market</span><span class="o">-</span><span class="nx">data</span><span class="o">/</span><span class="w">        </span><span class="c1">// CoinGecko, DeFiLlama, etc.</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span><span class="nx">crypto</span><span class="o">-</span><span class="nx">news</span><span class="o">/</span><span class="w">        </span><span class="c1">// RSS aggregation</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">  </span><span class="nx">external</span><span class="o">-</span><span class="nx">apis</span><span class="o">/</span><span class="w">      </span><span class="c1">// All external API configs</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">  </span><span class="nx">rate</span><span class="o">-</span><span class="nx">limit</span><span class="o">/</span><span class="w">         </span><span class="c1">// Rate limiting</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span><span class="nx">admin</span><span class="o">-</span><span class="nx">auth</span><span class="o">/</span><span class="w">         </span><span class="c1">// Secure admin auth (CDA version)</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">  </span><span class="nx">webhooks</span><span class="o">/</span><span class="w">           </span><span class="c1">// Webhook handling</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">  </span><span class="nx">x402</span><span class="o">/</span><span class="w">               </span><span class="c1">// Micropayment integration</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">  </span><span class="nx">groq</span><span class="o">/</span><span class="w">               </span><span class="c1">// AI integration</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">  </span><span class="nx">international</span><span class="o">/</span><span class="w">      </span><span class="c1">// International sources (FCN)</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">  </span><span class="nx">translate</span><span class="o">/</span><span class="w">          </span><span class="c1">// Translation services</span>
</span></code></pre></div> <h3 id="74-code-migration-snippets">7.4 Code Migration Snippets<a class="headerlink" href="#74-code-migration-snippets" title="Link to this section">¶</a></h3> <h4 id="adding-admin-auth-to-fcn">Adding Admin Auth to FCN<a class="headerlink" href="#adding-admin-auth-to-fcn" title="Link to this section">¶</a></h4> <p>Create <code>/workspaces/free-crypto-news/src/lib/admin-auth.ts</code>:</p> <div class="language-typescript highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="cm">/**</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="cm"> * Admin Authentication Utilities</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="cm"> * Migrated from CDA - centralized admin authentication</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="cm"> */</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NextRequest</span><span class="p">,</span><span class="w"> </span><span class="nx">NextResponse</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">'next/server'</span><span class="p">;</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isProduction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">'production'</span><span class="p">;</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="kd">function</span><span class="w"> </span><span class="nx">getAdminToken</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ADMIN_API_KEY</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ADMIN_TOKEN</span><span class="p">;</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">token</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">token</span><span class="p">;</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isProduction</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">'[Admin Auth] Using dev fallback token.'</span><span class="p">);</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">'dev-admin-token'</span><span class="p">;</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="p">}</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="kd">function</span><span class="w"> </span><span class="nx">secureCompare</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w">    </span><span class="nx">result</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="p">}</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="kd">function</span><span class="w"> </span><span class="nx">extractToken</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">authHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'Authorization'</span><span class="p">);</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">authHeader</span><span class="o">?</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">'Bearer '</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">authHeader</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">7</span><span class="p">);</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">adminKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'X-Admin-Key'</span><span class="p">);</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">adminKey</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">adminKey</span><span class="p">;</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a><span class="p">}</span>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">isAdminAuthorized</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">adminToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getAdminToken</span><span class="p">();</span>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">adminToken</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">requestToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">extractToken</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span>
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">requestToken</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">secureCompare</span><span class="p">(</span><span class="nx">requestToken</span><span class="p">,</span><span class="w"> </span><span class="nx">adminToken</span><span class="p">);</span>
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a><span class="p">}</span>
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">isAdminConfigured</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-46"><a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">getAdminToken</span><span class="p">()</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-7-47"><a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a><span class="p">}</span>
</span><span id="__span-7-48"><a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>
</span><span id="__span-7-49"><a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">requireAdminAuth</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">NextResponse</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-50"><a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isAdminConfigured</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-51"><a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span>
</span><span id="__span-7-52"><a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a><span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">'Service Unavailable'</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">isProduction</span><span class="w"> </span>
</span><span id="__span-7-53"><a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a><span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="s1">'Admin functionality is not configured'</span><span class="w"> </span>
</span><span id="__span-7-54"><a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="s1">'Set ADMIN_API_KEY environment variable'</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-7-55"><a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a><span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">503</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-56"><a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-7-57"><a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-7-58"><a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isAdminAuthorized</span><span class="p">(</span><span class="nx">request</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-59"><a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span>
</span><span id="__span-7-60"><a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a><span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">'Unauthorized'</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">'Invalid or missing admin credentials'</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-7-61"><a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a><span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">401</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-7-62"><a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-7-63"><a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-7-64"><a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-7-65"><a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a><span class="p">}</span>
</span></code></pre></div> <h4 id="adding-register-api-to-fcn">Adding Register API to FCN<a class="headerlink" href="#adding-register-api-to-fcn" title="Link to this section">¶</a></h4> <p>Create <code>/workspaces/free-crypto-news/src/app/api/register/route.ts</code>:</p> <div class="language-typescript highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NextRequest</span><span class="p">,</span><span class="w"> </span><span class="nx">NextResponse</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">'next/server'</span><span class="p">;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="nx">createApiKey</span><span class="p">,</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="nx">getKeysByEmail</span><span class="p">,</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="nx">revokeApiKey</span><span class="p">,</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span><span class="nx">API_KEY_TIERS</span><span class="p">,</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">  </span><span class="nx">isKvConfigured</span><span class="p">,</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">'@/lib/api-keys'</span><span class="p">;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">runtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'nodejs'</span><span class="p">;</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="kd">function</span><span class="w"> </span><span class="nx">isValidEmail</span><span class="p">(</span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="sr">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">email</span><span class="p">);</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="p">}</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">GET</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="nx">endpoint</span><span class="o">:</span><span class="w"> </span><span class="s1">'/api/register'</span><span class="p">,</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">'POST'</span><span class="p">,</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">    </span><span class="nx">description</span><span class="o">:</span><span class="w"> </span><span class="s1">'Register for a free API key'</span><span class="p">,</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">    </span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">        </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="s1">'string (required)'</span><span class="p">,</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">'string (optional)'</span><span class="p">,</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">    </span><span class="nx">tiers</span><span class="o">:</span><span class="w"> </span><span class="kt">Object.entries</span><span class="p">(</span><span class="nx">API_KEY_TIERS</span><span class="p">).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nx">tier</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="w">      </span><span class="nx">id</span><span class="p">,</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">tier.name</span><span class="p">,</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="w">      </span><span class="nx">requestsPerDay</span><span class="o">:</span><span class="w"> </span><span class="kt">tier.requestsPerDay</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">'Unlimited'</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">tier</span><span class="p">.</span><span class="nx">requestsPerDay</span><span class="p">,</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="w">    </span><span class="p">})),</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="w">    </span><span class="nx">configured</span><span class="o">:</span><span class="w"> </span><span class="kt">isKvConfigured</span><span class="p">(),</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a><span class="p">}</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a><span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">POST</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">email</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">action</span><span class="p">,</span><span class="w"> </span><span class="nx">keyId</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">body</span><span class="p">;</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">'revoke'</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">keyId</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isValidEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">'Invalid email'</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">400</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">revokeApiKey</span><span class="p">(</span><span class="nx">keyId</span><span class="p">,</span><span class="w"> </span><span class="nx">email</span><span class="p">);</span>
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span><span class="w"> </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">'Key revoked'</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">'Failed to revoke'</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">400</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a>
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">action</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">'list'</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isValidEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">'Invalid email'</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">400</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">getKeysByEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">);</span>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a><span class="w">      </span><span class="nx">keys</span><span class="o">:</span><span class="w"> </span><span class="kt">keys.map</span><span class="p">(</span><span class="nx">k</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a><span class="w">        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">k.id</span><span class="p">,</span>
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59" href="#__codelineno-8-59"></a><span class="w">        </span><span class="nx">keyPrefix</span><span class="o">:</span><span class="w"> </span><span class="kt">k.keyPrefix</span><span class="p">,</span>
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60" href="#__codelineno-8-60"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">k.name</span><span class="p">,</span>
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61" href="#__codelineno-8-61"></a><span class="w">        </span><span class="nx">tier</span><span class="o">:</span><span class="w"> </span><span class="kt">k.tier</span><span class="p">,</span>
</span><span id="__span-8-62"><a id="__codelineno-8-62" name="__codelineno-8-62" href="#__codelineno-8-62"></a><span class="w">        </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">k.createdAt</span><span class="p">,</span>
</span><span id="__span-8-63"><a id="__codelineno-8-63" name="__codelineno-8-63" href="#__codelineno-8-63"></a><span class="w">        </span><span class="nx">active</span><span class="o">:</span><span class="w"> </span><span class="kt">k.active</span><span class="p">,</span>
</span><span id="__span-8-64"><a id="__codelineno-8-64" name="__codelineno-8-64" href="#__codelineno-8-64"></a><span class="w">      </span><span class="p">})),</span>
</span><span id="__span-8-65"><a id="__codelineno-8-65" name="__codelineno-8-65" href="#__codelineno-8-65"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-8-66"><a id="__codelineno-8-66" name="__codelineno-8-66" href="#__codelineno-8-66"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-67"><a id="__codelineno-8-67" name="__codelineno-8-67" href="#__codelineno-8-67"></a>
</span><span id="__span-8-68"><a id="__codelineno-8-68" name="__codelineno-8-68" href="#__codelineno-8-68"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">email</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">isValidEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-69"><a id="__codelineno-8-69" name="__codelineno-8-69" href="#__codelineno-8-69"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">'Valid email is required'</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">400</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-8-70"><a id="__codelineno-8-70" name="__codelineno-8-70" href="#__codelineno-8-70"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-71"><a id="__codelineno-8-71" name="__codelineno-8-71" href="#__codelineno-8-71"></a>
</span><span id="__span-8-72"><a id="__codelineno-8-72" name="__codelineno-8-72" href="#__codelineno-8-72"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">createApiKey</span><span class="p">({</span><span class="w"> </span><span class="nx">email</span><span class="p">,</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">tier</span><span class="o">:</span><span class="w"> </span><span class="s1">'free'</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-8-73"><a id="__codelineno-8-73" name="__codelineno-8-73" href="#__codelineno-8-73"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="s1">'error'</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-74"><a id="__codelineno-8-74" name="__codelineno-8-74" href="#__codelineno-8-74"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">result.error</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">400</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-8-75"><a id="__codelineno-8-75" name="__codelineno-8-75" href="#__codelineno-8-75"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-76"><a id="__codelineno-8-76" name="__codelineno-8-76" href="#__codelineno-8-76"></a>
</span><span id="__span-8-77"><a id="__codelineno-8-77" name="__codelineno-8-77" href="#__codelineno-8-77"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
</span><span id="__span-8-78"><a id="__codelineno-8-78" name="__codelineno-8-78" href="#__codelineno-8-78"></a><span class="w">    </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="kt">result.key</span><span class="p">,</span>
</span><span id="__span-8-79"><a id="__codelineno-8-79" name="__codelineno-8-79" href="#__codelineno-8-79"></a><span class="w">    </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">'SAVE THIS KEY - it will only be shown once!'</span><span class="p">,</span>
</span><span id="__span-8-80"><a id="__codelineno-8-80" name="__codelineno-8-80" href="#__codelineno-8-80"></a><span class="w">    </span><span class="nx">tier</span><span class="o">:</span><span class="w"> </span><span class="kt">result.data.tier</span><span class="p">,</span>
</span><span id="__span-8-81"><a id="__codelineno-8-81" name="__codelineno-8-81" href="#__codelineno-8-81"></a><span class="w">    </span><span class="nx">rateLimit</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">API_KEY_TIERS</span><span class="p">[</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">tier</span><span class="p">].</span><span class="nx">requestsPerDay</span><span class="si">}</span><span class="sb"> requests/day`</span><span class="p">,</span>
</span><span id="__span-8-82"><a id="__codelineno-8-82" name="__codelineno-8-82" href="#__codelineno-8-82"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-8-83"><a id="__codelineno-8-83" name="__codelineno-8-83" href="#__codelineno-8-83"></a><span class="p">}</span>
</span></code></pre></div> <hr> <h2 id="summary">Summary<a class="headerlink" href="#summary" title="Link to this section">¶</a></h2> <h3 id="key-findings">Key Findings<a class="headerlink" href="#key-findings" title="Link to this section">¶</a></h3> <ol> <li><strong>95% Code Parity</strong>: Most API routes and utilities are identical between FCN and CDA</li> <li><strong>FCN Advantages</strong>: International news sources, i18n translation API, OpenAPI spec</li> <li><strong>CDA Advantages</strong>: Admin API management, user registration, usage tracking, cron jobs, secure auth</li> <li><strong>Shared Foundation</strong>: Identical market data, caching, rate limiting, premium APIs</li> </ol> <h3 id="recommended-actions">Recommended Actions<a class="headerlink" href="#recommended-actions" title="Link to this section">¶</a></h3> <ol> <li><strong>Immediate</strong>: Migrate <code>admin-auth.ts</code> from CDA to FCN (security improvement)</li> <li><strong>Short-term</strong>: Add <code>/api/register</code> and <code>/api/v1/usage</code> to FCN for API key self-service</li> <li><strong>Medium-term</strong>: Add international sources to CDA for global news coverage</li> <li><strong>Long-term</strong>: Create shared package for common utilities</li> </ol> <hr> <p><em>Document generated by API comparison analysis</em></p> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="Last update"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="January 24, 2026 05:13:43 UTC"><span class="timeago" datetime="2026-01-24T05:13:43+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="January 24, 2026 05:13:43 UTC">2026-01-24</span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="Created"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="January 24, 2026 05:13:43 UTC"><span class="timeago" datetime="2026-01-24T05:13:43+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="January 24, 2026 05:13:43 UTC">2026-01-24</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type="button" class="md-top md-icon" data-md-component="top" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright © 2024–2026 Free Crypto News – <a href="#__consent">Change cookie settings</a> </div> </div> <div class="md-social"> <a href="https://github.com/nirholas/free-crypto-news" target="_blank" rel="noopener" title="github.com" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a href="https://discord.gg/cryptonews" target="_blank" rel="noopener" title="discord.gg" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"></path></svg> </a> <a href="https://twitter.com/freecryptonews" target="_blank" rel="noopener" title="twitter.com" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-consent" data-md-component="consent" id="__consent" hidden> <div class="md-consent__overlay"></div> <aside class="md-consent__inner"> <form class="md-consent__form md-grid md-typeset" name="consent"> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation.</p> <input class="md-toggle" type="checkbox" id="__settings"> <div class="md-consent__settings"> <ul class="task-list"> <li class="task-list-item"> <label class="task-list-control"> <input type="checkbox" name="analytics" checked> <span class="task-list-indicator"></span> Google Analytics </label> </li> <li class="task-list-item"> <label class="task-list-control"> <input type="checkbox" name="github" checked> <span class="task-list-indicator"></span> GitHub </label> </li> </ul> </div> <div class="md-consent__controls"> <button class="md-button md-button--primary">Accept</button> <label class="md-button" for="__settings">Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "content.tooltips", "toc.follow", "header.autohide", "announce.dismiss"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src="../assets/javascripts/bundle.79ae519e.min.js"></script> <script src="../js/timeago.min.js"></script> <script src="../js/timeago_mkdocs_material.js"></script>  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>