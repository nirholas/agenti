{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Lyra Intel Analysis Result",
  "description": "Schema for analysis output",
  "type": "object",
  "properties": {
    "repository": {
      "type": "object",
      "properties": {
        "path": { "type": "string" },
        "name": { "type": "string" },
        "url": { "type": "string" },
        "branch": { "type": "string" }
      },
      "required": ["path", "name"]
    },
    "analysis": {
      "type": "object",
      "properties": {
        "started_at": { "type": "string", "format": "date-time" },
        "completed_at": { "type": "string", "format": "date-time" },
        "duration_seconds": { "type": "number" },
        "mode": { "type": "string", "enum": ["local", "distributed", "cloud_massive"] }
      }
    },
    "files": {
      "type": "object",
      "properties": {
        "total": { "type": "integer" },
        "by_extension": { "type": "object" },
        "total_lines": { "type": "integer" },
        "total_size_bytes": { "type": "integer" }
      }
    },
    "code_units": {
      "type": "object",
      "properties": {
        "total": { "type": "integer" },
        "functions": { "type": "integer" },
        "classes": { "type": "integer" },
        "by_language": { "type": "object" }
      }
    },
    "dependencies": {
      "type": "object",
      "properties": {
        "total": { "type": "integer" },
        "internal": { "type": "integer" },
        "external": { "type": "integer" },
        "circular": { "type": "array", "items": { "type": "array", "items": { "type": "string" } } }
      }
    },
    "commits": {
      "type": "object",
      "properties": {
        "total": { "type": "integer" },
        "authors": { "type": "integer" },
        "date_range": {
          "type": "object",
          "properties": {
            "earliest": { "type": "string", "format": "date-time" },
            "latest": { "type": "string", "format": "date-time" }
          }
        }
      }
    },
    "patterns": {
      "type": "object",
      "properties": {
        "total": { "type": "integer" },
        "by_category": { "type": "object" },
        "by_severity": { "type": "object" },
        "critical_issues": { "type": "array" }
      }
    }
  }
}
